function gfRepeater_getRepeaters(){var e,t=0,r=0,a=0,p={},n={};jQuery(".gfield").each(function(){if(0==t)jQuery(this).has(".gf-repeater-start").length&&(r+=1,gfRepeater_debug&&console.log("Repeater #"+r+" - Start: "+jQuery(this).attr("id")),e=jQuery("#"+this.id+" input.gform_hidden"),t=1);else if(jQuery(this).has(".gf-repeater-end").length){gfRepeater_debug&&(console.log("Repeater #"+r+" - End: "+jQuery(this).attr("id")),console.log("Repeater #"+r+" - Children Found: "+a));var i={},s=jQuery("#"+this.id+" .gf-repeater-end .gf-repeater-add"),u=jQuery("#"+this.id+" .gf-repeater-end .gf-repeater-remove");jQuery(s).attr("onClick","gfRepeater_repeatRepeater("+r+");"),jQuery(u).attr("onClick","gfRepeater_unrepeatRepeater("+r+");"),i={add:s,remove:u,data:e};var f={},d=e.attr("data-start"),o=e.attr("data-min"),g=e.attr("data-max");d||(d=1),o||(o=1),o>g&&(g=null),f={start:d,min:o,max:g};var R={};R={repeatCount:1,childrenCount:a,inputData:n},gfRepeater_repeaters[r]={data:R,settings:f,controllers:i,children:p},gfRepeater_updateDataElement(r),a=0,p={},t=0}else{a+=1;var l=jQuery(this),_=jQuery(this).children(".gfield_label").text(),c=jQuery(this).attr("id"),h={},y=[],j=1;gfRepeater_debug&&console.log("Repeater #"+r+" - Child #"+a+" - Found: "+c),jQuery(this).find(":input").each(function(){j+=1;var e=jQuery(this),t=jQuery(this).attr("id"),p=jQuery(this).attr("name");p&&-1==jQuery.inArray(p,y)&&y.push(p),h[j]={element:e,id:t,name:p},gfRepeater_debug&&console.log("Repeater #"+r+" - Child #"+a+" - Input Found: "+t)}),p[a]={element:l,id:c,inputs:h,inputCount:j},n[_]=y}}),gfRepeater_debug&&console.log("Repeaters Found: "+r)}function gfRepeater_setRepeaterChildAttrs(e,t,r){if(!r)var r=gfRepeater_repeaters[t].data.repeatCount+1;var a,p=jQuery(e).attr("id").split("-")[0];if(jQuery.each(gfRepeater_repeaters[t].children,function(e){return this.id==p?void(a=e):void 0}),a){var n=p+"-"+t+"-"+r;jQuery(e).attr("id",n),jQuery.each(gfRepeater_repeaters[t].children[a].inputs,function(){var a=this.id,p=this.name;if(a)var n=jQuery(e).find(":input[id^='"+a+"']");else{if(!p)return;var n=jQuery(e).find(":input[name^='"+p+"']")}if(a){var i=a+"-"+t+"-"+r;jQuery(n).attr("id",i),jQuery(e).find("label[for^='"+a+"']").attr("for",i)}if(p){var s=p+"-"+t+"-"+r;jQuery(n).attr("name",s)}var u=jQuery(n).attr("data-mask");u&&jQuery(n).mask(u)})}}function gfRepeater_repeatRepeater(e){if(!(gfRepeater_repeaters[e].settings.max&&gfRepeater_repeaters[e].data.repeatCount>=gfRepeater_repeaters[e].settings.max)){var t=gfRepeater_repeaters[e].data.childrenCount,r=gfRepeater_repeaters[e].children[t].element;r=r.attr("id"),r=jQuery("#"+r.slice(0,-1)+gfRepeater_repeaters[e].data.repeatCount),jQuery.each(gfRepeater_repeaters[e].children,function(t){var a=jQuery(this.element).clone();gfRepeater_resetInputs(e,t,a),jQuery(a).insertAfter(r),gfRepeater_setRepeaterChildAttrs(jQuery(a),e),r=a}),gfRepeater_repeaters[e].data.repeatCount+=1,gfRepeater_updateDataElement(e),gfRepeater_updateRepeaterControls(e),gfRepeater_debug&&console.log("Repeater #"+e+" - repeated")}}function gfRepeater_unrepeatRepeater(e,t){if(!(gfRepeater_repeaters[e].data.repeatCount<=gfRepeater_repeaters[e].settings.min)){if(!t)var t=gfRepeater_repeaters[e].data.repeatCount;jQuery.each(gfRepeater_repeaters[e].children,function(){var r=jQuery("#"+this.id+"-"+e+"-"+t);jQuery(r).remove()}),gfRepeater_repeaters[e].data.repeatCount-=1,gfRepeater_updateDataElement(e),gfRepeater_updateRepeaterControls(e),gfRepeater_debug&&console.log("Repeater #"+e+" - Child #"+t+" - unrepeated")}}function gfRepeater_updateRepeaterControls(e){gfRepeater_repeaters[e].settings.max&&(gfRepeater_repeaters[e].data.repeatCount==gfRepeater_repeaters[e].settings.max?jQuery(gfRepeater_repeaters[e].controllers.add).hide():jQuery(gfRepeater_repeaters[e].controllers.add).show()),gfRepeater_repeaters[e].data.repeatCount==gfRepeater_repeaters[e].settings.min?jQuery(gfRepeater_repeaters[e].controllers.remove).hide():jQuery(gfRepeater_repeaters[e].controllers.remove).show()}function gfRepeater_resetInputs(e,t,r){jQuery.each(gfRepeater_repeaters[e].children[t].inputs,function(){var e=this.id,t=this.name;if(e)var a=jQuery(r).find("[id^='"+e+"']");else{if(!t)return;var a=jQuery(r).find("[name^='"+t+"']")}a&&(a.is(":checkbox, :radio")?a.prop("checked",!1):a.val(""))})}function gfRepeater_updateDataElement(e){var t=jQuery(gfRepeater_repeaters[e].controllers.data),r=JSON.stringify({repeaterId:e,repeatCount:gfRepeater_repeaters[e].data.repeatCount,inputData:gfRepeater_repeaters[e].data.inputData});jQuery(t).val(r)}function gfRepeater_start(){jQuery.each(gfRepeater_repeaters,function(e){var t=e;for(jQuery.each(gfRepeater_repeaters[t].children,function(e){gfRepeater_setRepeaterChildAttrs(jQuery(gfRepeater_repeaters[t].children[e].element),t,1)}),i=1;i<gfRepeater_repeaters[t].settings.start;i++)gfRepeater_repeatRepeater(t);gfRepeater_updateRepeaterControls(t)})}function gfRepeater_patchMask(){var e=jQuery.fn.mask;jQuery.fn.mask=function(t){return jQuery(this.get(0)).attr("data-mask",t),e.apply(this,arguments)}}var gfRepeater_debug=!1,gfRepeater_repeaters={};jQuery(window).load(function(){gfRepeater_getRepeaters(),gfRepeater_start()}),jQuery(document).ready(function(){gfRepeater_patchMask()}),gfRepeater_debug&&jQuery(window).keydown(function(e){38==e.which&&console.log(gfRepeater_repeaters)});